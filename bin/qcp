#!/usr/bin/zsh

if ! [[ "$(pwd)/" =~ "./deft/.*" ]]; then
  echo 'not within deft directory'
  exit 1
fi

remote_deft='perlinm@wentworth.physics.oregonstate.edu:~/deft'

local_dir=$(pwd)
remote_dir=$remote_deft$(pwd | sed 's/.*deft//')

if [ $# -le 1 ] && (! [ $1 = up ] || ! [ $1 = down ]); then

  echo "usage:" $(basename $0) "[up/down] target"
  exit 1

elif [ $1 = up ]; then

  from=$local_dir
  to=$remote_dir

elif [ $1 = down ]; then

  from=$remote_dir
  to=$local_dir

fi

for i in ${*:2}; do

  scp -pr $from/$i $to/$(dirname $i)/

done
