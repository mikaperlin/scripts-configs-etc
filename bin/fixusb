#!/usr/bin/python3
import sys, os, subprocess

if len(sys.argv) not in [1,2]:
    print("usage: format [drive]")
    exit(-1)

if len(sys.argv) == 1:
    drive = '/dev/sdc1'
    print('defaulting to drive:',drive)
elif len(sys.argv) == 2:
    drive = sys.argv[1]
else:
    print("usage: format [drive]")
    exit(-1)

if not os.path.exists(drive):
    print("drive",drive,"does not exist")
    exit(-1)

def check(exitStatus):
  if exitStatus != 0:
    print('terminating due to nonzero exit status:',exitStatus)
    exit(-1)

check(subprocess.call(['sudo','umount',drive]))
check(subprocess.call(['sudo','dosfsck','-av',drive]))
