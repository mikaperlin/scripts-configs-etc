#!/usr/bin/python3
import sys, os, subprocess

if len(sys.argv) != 3:
    print("usage: format [drive] [label]")
    exit(-1)

drive = sys.argv[1]
label = sys.argv[2]

if 'sda' or 'sdb' in drive:
    print('will not format:',drive)
    exit(-1)

if not os.path.exists(drive):
    print("drive",drive,"does not exist")
    exit(-1)

def check(exitStatus):
  if exitStatus != 0:
    print('Terminating due to nonzero exit status:',exitStatus)
    exit(-1)

check(subprocess.call(['sudo','umount',drive]))
check(subprocess.call(['sudo','mkdosfs','-F','32','-I',drive]))
check(subprocess.call(['sudo','mlabel','-i',drive,'::%s'%label]))
